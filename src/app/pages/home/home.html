<div class="home-container">
  <!-- T√≠tulo -->
  <h2>GasolineraFinder</h2>
  
  <!-- Estado de carga y errores -->
  <div *ngIf="cargando" class="loading">
    <p>üîÑ Cargando gasolineras...</p>
  </div>
  
  <div *ngIf="error" class="error">
    <p>‚ùå {{ error }}</p>
    <button (click)="recargarGasolineras()">Reintentar</button>
  </div>
  
  <!-- Selector de ubicaci√≥n (comentado hasta que tengas el componente) -->
  <!-- 
  <app-location-selector 
    (locationChange)="onUbicacionCambiada($event)">
  </app-location-selector>
  -->
  
  <!-- Informaci√≥n de ubicaci√≥n actual -->
  <div class="location-info">
    <strong>üìç Ubicaci√≥n actual:</strong>
    <span *ngIf="ubicacionUsuario; else noLoc">
      {{ ubicacionUsuario.latitud | number:'1.4-4' }}, {{ ubicacionUsuario.longitud | number:'1.4-4' }}
      <span *ngIf="ubicacionUsuario.ciudad">- {{ ubicacionUsuario.ciudad }}</span>
    </span>
    <ng-template #noLoc>Sin ubicaci√≥n seleccionada.</ng-template>
    <button (click)="obtenerUbicacion()" style="margin-left: 10px;">üìç Obtener mi ubicaci√≥n</button>
  </div>
  
  <!-- Filtros (comentado hasta que tengas el componente) -->
  <!-- 
  <app-filters 
    [empresasDisponibles]="empresasDisponibles"
    [filtros]="filtros"
    (filterChange)="onFiltrosCambiados($event)">
  </app-filters>
  -->
  
  <!-- Filtros actuales (para debug) -->
  <div class="filters-info" *ngIf="filtros">
    <strong>‚öôÔ∏è Filtros actuales:</strong>
    <ul>
      <li>Tipo combustible: {{ filtros.tipoCombustible }}</li>
      <li>Distancia m√°xima: {{ filtros.distanciaMaxima }} km</li>
      <li>Precio m√°ximo: {{ filtros.precioMaximo > 0 ? (filtros.precioMaximo | number:'1.2-2') + '‚Ç¨' : 'Sin l√≠mite' }}</li>
      <li>Solo abiertas: {{ filtros.soloAbiertas ? 'S√≠' : 'No' }}</li>
      <li>Ordenar por: {{ filtros.ordenarPor }}</li>
      <li *ngIf="filtros.empresas.length > 0">Empresas seleccionadas: {{ filtros.empresas.join(', ') }}</li>
    </ul>
  </div>
  
  <!-- Resumen (comentado hasta que tengas el componente) -->
  <!-- 
  <app-summary-box
    [stations]="gasolinerasFiltradas"
    [filters]="filtros">
  </app-summary-box>
  -->
  
  <!-- Contador de resultados -->
  <div class="results-count" *ngIf="gasolinerasFiltradas.length > 0">
    <strong>üìä Resultados:</strong> {{ gasolinerasFiltradas.length }} gasolineras encontradas
    (de {{ gasolineras.length }} totales)
  </div>
  
  <!-- Lista de gasolineras -->
  <div *ngIf="gasolinerasFiltradas.length > 0 && !cargando">
    <!-- Lista de gasolineras (comentado hasta que tengas el componente) -->
    <!-- 
    <app-station-list
      [stations]="gasolinerasFiltradas"
      [filters]="filtros"
      (stationSelected)="onGasolineraSeleccionada($event)">
    </app-station-list>
    -->
    
    <!-- Tabla temporal de gasolineras -->
    <div class="stations-table">
      <h3>Gasolineras cercanas</h3>
      <table>
        <thead>
          <tr>
            <th>Empresa</th>
            <th>Direcci√≥n</th>
            <th>Municipio</th>
            <th>Gasolina 95</th>
            <th>Gas√≥leo A</th>
            <th>Distancia</th>
            <th>Horario</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let gasolinera of gasolinerasFiltradas | slice:0:10">
            <td><strong>{{ gasolinera.rotulo }}</strong></td>
            <td>{{ gasolinera.direccion }}</td>
            <td>{{ gasolinera.municipio }} ({{ gasolinera.provincia }})</td>
            <td>
              <span *ngIf="gasolinera.precioGasolina95 > 0; else na">
                {{ gasolinera.precioGasolina95 | number:'1.3-3' }}‚Ç¨
              </span>
              <ng-template #na>N/A</ng-template>
            </td>
            <td>
              <span *ngIf="gasolinera.precioDiesel > 0; else na2">
                {{ gasolinera.precioDiesel | number:'1.3-3' }}‚Ç¨
              </span>
              <ng-template #na2>N/A</ng-template>
            </td>
            <td>
              <span *ngIf="gasolinera.distanceKm">
                {{ gasolinera.distanceKm | number:'1.1-1' }} km
              </span>
              <span *ngIf="!gasolinera.distanceKm">-</span>
            </td>
            <td>{{ gasolinera.horario || 'No especificado' }}</td>
            <td>
              <button (click)="onGasolineraSeleccionada(gasolinera)">Ver detalles</button>
            </td>
          </tr>
        </tbody>
      </table>
      <p *ngIf="gasolinerasFiltradas.length > 10">
        Mostrando 10 de {{ gasolinerasFiltradas.length }} gasolineras
      </p>
    </div>
  </div>
  
  <!-- Sin resultados -->
  <div *ngIf="gasolinerasFiltradas.length === 0 && !cargando && !error" class="no-results">
    <p>No se encontraron gasolineras con los filtros actuales.</p>
    <button (click)="cargarGasolineras()">Recargar datos</button>
  </div>
  
  <!-- Detalles de gasolinera seleccionada -->
  <div *ngIf="gasolineraSeleccionada" class="station-details">
    <h3>Detalles de {{ gasolineraSeleccionada.rotulo }}</h3>
    <div class="details-grid">
      <div><strong>Direcci√≥n:</strong> {{ gasolineraSeleccionada.direccion }}</div>
      <div><strong>Localidad:</strong> {{ gasolineraSeleccionada.localidad }}</div>
      <div><strong>Municipio:</strong> {{ gasolineraSeleccionada.municipio }}</div>
      <div><strong>Provincia:</strong> {{ gasolineraSeleccionada.provincia }}</div>
      <div><strong>C√≥digo Postal:</strong> {{ gasolineraSeleccionada.codigoPostal }}</div>
      <div><strong>Horario:</strong> {{ gasolineraSeleccionada.horario }}</div>
    </div>
    
    <h4>Precios</h4>
    <div class="prices-grid">
      <div *ngIf="gasolineraSeleccionada.precioGasolina95 > 0">
        <strong>Gasolina 95:</strong> {{ gasolineraSeleccionada.precioGasolina95 | number:'1.3-3' }}‚Ç¨
      </div>
      <div *ngIf="gasolineraSeleccionada.precioGasolina98 > 0">
        <strong>Gasolina 98:</strong> {{ gasolineraSeleccionada.precioGasolina98 | number:'1.3-3' }}‚Ç¨
      </div>
      <div *ngIf="gasolineraSeleccionada.precioDiesel > 0">
        <strong>Gas√≥leo A:</strong> {{ gasolineraSeleccionada.precioDiesel | number:'1.3-3' }}‚Ç¨
      </div>
      <div *ngIf="gasolineraSeleccionada.precioDieselPremium > 0">
        <strong>Gas√≥leo Premium:</strong> {{ gasolineraSeleccionada.precioDieselPremium | number:'1.3-3' }}‚Ç¨
      </div>
      <div *ngIf="gasolineraSeleccionada.precioGLP > 0">
        <strong>GLP:</strong> {{ gasolineraSeleccionada.precioGLP | number:'1.3-3' }}‚Ç¨
      </div>
    </div>
    
    <button (click)="gasolineraSeleccionada = null">Cerrar detalles</button>
  </div>
  
  <!-- Debug info -->
  <div class="debug-info" *ngIf="false"> <!-- Cambia a *ngIf="true" para debug -->
    <hr />
    <h4>Informaci√≥n de depuraci√≥n</h4>
    <div>
      <strong>Gasolineras totales:</strong> {{ gasolineras.length }}
    </div>
    <div>
      <strong>Gasolineras filtradas:</strong> {{ gasolinerasFiltradas.length }}
    </div>
    <div>
      <strong>Ubicaci√≥n:</strong> {{ ubicacionUsuario | json }}
    </div>
    <div>
      <strong>Filtros:</strong> {{ filtros | json }}
    </div>
    <button (click)="recargarGasolineras()">Recargar datos</button>
  </div>
</div>